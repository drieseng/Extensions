<Project DefaultTargets="Test">

  <!-- Version included until we get global.json generation to support this SDK. -->
  <Sdk Name="Microsoft.DotNet.Helix.Sdk" Version="1.0.0-beta.18502.3" />

  <PropertyGroup>
    <TestDirectory>Microsoft.Extensions.CommandLineUtils.Tests</TestDirectory>

    <!-- The 'source' value reported to helix  -->
    <HelixSource>pr/extensions/test/$(TestDirectory)</HelixSource>
    <!-- The 'type' value reported to helix  -->
    <HelixType>test/haok</HelixType>
    <!-- The 'build' value reported to helix  -->
    <HelixBuild>10-29-2</HelixBuild>
    <HelixAccessToken>e888ebc345b7d82c5cf54b4501fc430433deb6eb</HelixAccessToken>


    <!-- The helix queue this job should run on. -->
    <HelixTargetQueue>Windows.10.Amd64.Open</HelixTargetQueue>

    <!--
      The set of helix queues to send jobs to.
      This property is multiplexed over just like <TargetFrameworks> for C# projects.
      The project is built once per entry in this list with <HelixTargetQueue> set to the current list element value.
    -->
    <HelixTargetQueues>Windows.10.Amd64.Open</HelixTargetQueues>


    <!--
      'true' to enable the xunit reporter. Default 'false'
      The xunit reporter will report test results from a test results
      xml file found in the work item working directory.
      The following file names are accepted:
        testResults.xml
        test-results.xml
        test_results.xml
    -->
    <EnableXUnitReporter>true</EnableXUnitReporter>

    <!--
      Commands that are run before each workitem's command
      semicolon separated; use ';;' to escape a single semicolon
    -->
    <HelixPreCommands>$(HelixPreCommands);echo 'before'</HelixPreCommands>

    <!--
      Commands that are run after each workitem's command
      semicolon separated; use ';;' to escape a single semicolon
    -->
    <HelixPostCommands>$(HelixPostCommands);echo 'after'</HelixPostCommands>
  </PropertyGroup>

  <ItemGroup>
    <!-- Directory that is zipped up and sent as a correlation payload -->
    <HelixCorrelationPayload Include="..\testassets" />

    <!-- Workitem that is run on a machine from the $(HelixTargetQueue) queue -->
    <HelixWorkItem Include="Xunit">
      <!-- Command that runs the work item -->
      <Command>xunit.console.exe $(TestDirectory).dll -xml testResults.xml</Command>

      <!-- A directory that is zipped up and send as the work item payload -->
      <PayloadDirectory>..\testassets\$(TestDirectory)</PayloadDirectory>

      <!-- A TimeSpan that specifies the work item execution timeout -->
      <Timeout>00:30:00</Timeout>

      <!-- Commands that will run before the work item command -->
      <PreCommands>echo 'pepperoni';echo 'cheese'</PreCommands>

      <!-- Commands that will run after the work item command -->
      <PostCommands>echo 'crust';echo 'oven'</PostCommands>
    </HelixWorkItem>
  </ItemGroup>
</Project>